# Summary: Flask Application Service
# Description:
# Exposes the Flask application running in the Deployment.
# The service type determines accessibility:
# - ClusterIP: internal-only access within the cluster
# - NodePort: exposes the app on each node's IP/port
# - LoadBalancer: provisions a cloud load balancer (AWS ELB)

apiVersion: v1
kind: Service
metadata:
  name: {{ .Chart.Name }}-service                  # Service name for the Flask web app
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-attributes: deletion_protection.enabled=false

spec:
  type: {{ .Values.service.type }}                 # Service type (NodePort / ClusterIP / LoadBalancer)
  selector:
    app: {{ .Values.app.name }}                    # Target pods using the app label
  ports:
    - port: 80                                     # Exposed service port
      targetPort: {{ .Values.app.port }}           # Flask container port
      protocol: TCP

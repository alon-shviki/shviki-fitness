# Summary: Central Configuration File for Helm Chart
# Description:
# This file serves as the central configuration point for the entire Helm chart.
# It defines all key parameters—such as image, ports, secrets, resources, storage, and autoscaling—
# used across all templates. Helm dynamically injects these values into your manifests at deployment time,
# making the setup modular, reusable, and easy to maintain.

# Flask Application Configuration
app:
  name: shviki-app                       # Logical name for the Flask Deployment
  image: "alon2810/shvikifitness:e52986d" # Docker image for your Flask app
  replicas: 1                            # Number of Flask pods (can scale via HPA)
  port: 5000                             # Port Flask listens on inside the container

  # Resource allocations for the Flask container
  resources:
    requests:
      cpu: 100m        # Minimum guaranteed CPU (0.1 core)
      memory: 128Mi    # Minimum guaranteed memory
    limits:
      cpu: 300m        # Maximum CPU before throttling
      memory: 256Mi    # Maximum memory limit

# MySQL Database Configuration
mysql:
  image: "mysql:8.0"                     # MySQL container image
  database: "shviki_db"                  # Default database name
  user: "shviki"                         # Application database username
  port: 3306                             # MySQL container port

  storage:                               # Persistent volume configuration
    size: 1Gi                            # Volume size for MySQL data
    class: "gp3-ebs"                    # Storage class for the persistent volume

  secretName: shviki-mysql-secret        # Name of the Kubernetes Secret with MySQL credentials

  # Resource allocations for the MySQL container
  resources:
    requests:
      cpu: 100m        # Minimum guaranteed CPU for MySQL
      memory: 256Mi    # Minimum guaranteed memory
    limits:
      cpu: 500m        # Maximum CPU for MySQL pod
      memory: 512Mi    # Maximum memory before throttling

# Service Configuration
service:
  type: LoadBalancer                    # Service type (ClusterIP, NodePort, LoadBalancer)
  port: 80                               # Cluster-internal port
  
# Secret Values (Injected into Kubernetes Secrets)
secret:
  mysql:
    rootPassword: "root123"              # Root password for MySQL
    userPassword: "shviki123"            # Application user password

  app:
    secretKey: "replace-with-generated-key"  # Flask SECRET_KEY used for sessions, cookies, CSRF tokens

# Autoscaling Configuration
autoscaling:
  enabled: true                          # Enable the Horizontal Pod Autoscaler
  minReplicas: 1                         # Minimum Flask replicas
  maxReplicas: 3                         # Maximum Flask replicas
  targetCPUUtilizationPercentage: 70     # Target CPU utilization threshold for scaling
